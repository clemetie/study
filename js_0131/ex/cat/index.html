<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê³ ì–‘ì´ ê·€ì—¬ì›Œ</title>
    <style>
      a {
        text-decoration: none;
        color: #333;
      }
      #catlist {
        display: flex;
        margin: 0 auto;
        flex-wrap: wrap;
        width: 1000px;
        /* background-color: aquamarine; */
        justify-content: space-between;
      }

      .cat-card {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 10px;
        width: calc(30% - 20px);
        margin: 0 auto;
        background-color: rgb(230, 202, 149);
      }

      .cat-image {
        width: 100%;
        height: 300px;
        object-fit: cover;
        display: block;
        margin: 0 auto;
      }
      .pagination {
        display: flex;
        justify-content: center;
        margin-top: 20px;
      }

      .page-link {
        margin: 0 5px;
        padding: 10px 15px;
        background-color: #3498db;
        /* ë°°ê²½ìƒ‰ */
        color: #fff;
        /* ê¸€ê¼´ìƒ‰ */
        border: none;
        border-radius: 20px;
        /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */

        font-weight: bold;
        transition: background-color 0.3s;
        /* í˜¸ë²„ íš¨ê³¼ */
      }

      .page-link:hover {
        background-color: #2980b9;
        /* í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ ë³€ê²½ */
      }
      .active-page {
        background-color: #29b96a;
      }
      .disabled {
        background-color: #aaaaaa;
      }
    </style>
  </head>
  <body>
    <div id="catlist">
      <!-- JS -->
    </div>
    <div class="pagination" id="pagination">
      <!-- js -->
    </div>
    <script>
      //   let notice = [];
      const itemsPerPage = 3;
      let currentPage = 1;
      const catList = document.querySelector("#catlist");
      const paginationDiv = document.getElementById("pagination");
      const prevBtn = document.createElement("a");
      const nextBtn = document.createElement("a");
      //urlì—ì„œ ì¿¼ë¦¬ë¬¸ìì—´ì„ ì½ì–´ì™€ì„œ ê³ ì–‘ì´ ì•„ì´ë””ë¥¼ ê°€ì ¸ì˜´. .
      const urlParams = new URLSearchParams(window.location.search); // URLSearchParams() <= ë©”ì„œë“œ
      const catId = urlParams.get("id");
      //ê³ ì–‘ì´ê·€ì—¬ì›Œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ í™”ë©´ì— ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ ë§Œë“¤ê±°ì–Œ
      function displayCatInfo(page) {
        // console.log(page); // 1;
        fetch("cat.json")
          .then((response) => response.json())
          .then((data) => {
            //í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°í•˜ê¸°
            const startIndex = (page - 1) * itemsPerPage; // ì‹œì‘ ì¸ë±ìŠ¤ ë²ˆí˜¸ë¥¼ 0ìœ¼ë¡œ ë§Œë“¦
            const endIndex = startIndex + itemsPerPage; // í˜ì´ì§€ë‹¹ ë³´ì—¬ì¤„ ì¸ë±ìŠ¤ ë§ˆì§€ë§‰ ë²ˆí˜¸ ë§Œë“¦
            const catsOnPage = data.slice(startIndex, endIndex); //data(cat.json ë‚´ìš©)ì„ 0~2ê¹Œì§€ë§Œ ìë¦„
            // console.log(catsOnPage); // ê³ ì–‘ì´jsonì˜ ì¸ë±ìŠ¤ 0~2ê¹Œì§€ ë“¤ì–´ì˜´
            catsOnPage.forEach((cat) => {
              // 0~2ê¹Œì§€ ì´ ê³ ì–‘ì´ 3ë§ˆë¦¬ë§Œ ! ê° ìš”ì†Œë¡œ ëŒë¦¼
              const catCard = document.createElement("div");
              catCard.className = "cat-card";
              catCard.innerHTML = `
                  <a href="catcate.html?id=${cat.id}">
                    <img class="cat-image" src="${cat.url}" alt="${cat.title}" />
                    <h3>ğŸ˜»${cat.title}ğŸ˜»</h3>
                    <p>íŠ¹ì§•: ${cat.description} </p>
                  </a>`;
              catList.appendChild(catCard);
            });
            //í˜ì´ì§€ë„¤ì´ì…˜ í•¨ìˆ˜ ë§Œë“¤ê¸°
            pagination(data.length);
          })
          .catch((error) => {
            console.error(error);
          });
      }
      // í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„±
      function pagination(totalItems) {
        // console.log(totalItems); // 10 ; ì™œëƒë©´ ê³ ì–‘ì´.jsonì— ê°ì²´ê°€ 10ê°œì„
        paginationDiv.innerHTML = "";
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        for (let i = 1; i <= totalPages; i++) {
          //   console.log(i);
          const pageLink = document.createElement("a");
          pageLink.className = "page-link";
          pageLink.href = `?id=${catId}&page=${i}`;
          //   console.log(pageLink);
          pageLink.textContent = i;
          if (i === currentPage) {
            pageLink.classList.add("active-page");
          }
          paginationDiv.appendChild(pageLink);
        }
        //ì´ì „ë²„íŠ¼ ë§Œë“¤ê¸°
        prevBtn.className = "page-link";
        // console.log(prevBtn);
        prevBtn.textContent = "ì´ì „";
        if (currentPage > 1) {
          prevBtn.href = `?id=${catId}&page=${currentPage - 1}`;
        } else {
          prevBtn.classList.add("disabled");
        }
        paginationDiv.insertBefore(prevBtn, paginationDiv.firstChild);
        //ë‹¤ìŒë²„íŠ¼ ë§Œë“¤ê¸°
        nextBtn.className = "page-link";
        nextBtn.textContent = "ë‹¤ìŒ";
        if (currentPage < totalPages) {
          nextBtn.href = `?id=${catId}&page=${currentPage + 1}`;
        } else {
          nextBtn.classList.add("disabled");
        }
        paginationDiv.appendChild(nextBtn);
      }
      // í˜ì´ì§€ ë¡œë“œë  ë•Œ ê³ ì–‘ì´ ì „ì²´ ì •ë³´ ì¶œë ¥í•˜ê¸°
      const pageParam = urlParams.get("page");
      if (pageParam) {
        currentPage = parseInt(pageParam)
      }
      displayCatInfo(currentPage);
    </script>
  </body>
</html>
